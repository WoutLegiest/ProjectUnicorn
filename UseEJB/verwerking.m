pkg load signal 
data = [0.38053513, 0.5725889, 0.75391483, 0.8707609, 0.76468897, 0.6828947, 0.64988756, 0.5297551, 0.44485474, 0.12365484, 0.09262657, 0.12292671, 0.38939714, 0.5619755, 0.6853943, 0.53801394, 0.23846817, 0.12174225, 0.08068752, 0.11537075, 0.25121355, 0.3216834, 0.27770424, 0.3010397, 0.21807337, 0.13896465, 0.46623325, 0.45271254, 0.01929617, -0.14118528, -0.13829374, 0.05382681, 0.18823957, 0.28080463, 0.26878595, 0.20223999, 0.08663845, 0.033609867, 0.015514374, 0.072886944, 0.18958902, 0.22939014, 0.18983221, 0.1608944, 0.13547087, 0.06800079, 0.06807804, 0.02931261, 0.13362885, 0.097073555, 0.15084791, 0.20499945, 0.017977238, 0.029739857, 0.16517067, 0.06910515, 0.017409325, 0.18789387, 0.08198452, 0.027135849, -0.008440018, 0.05748558, 0.10002041, 0.0932312, 0.034062386, 0.009495735, -0.0012989044, 0.08103657, 0.11369038, -0.017663002, 0.49600315, -0.19968128, 0.021740913, -0.017638206, 0.09773636, 0.07318878, 0.09775925, 0.08904934, 0.051665306, 0.02475357, 0.038646698, -0.042552948, 0.07299423, 0.075037956, 0.13077545, 0.03404522, 0.034674644, -0.026062965, -0.085510254, 0.15620518, -0.011760712, -0.083898544, -0.06903362, 0.019666672, -0.024564743, -0.01176548, -0.029413223, -0.011748314, -0.008564949, 0.086541176, 0.12138653, 0.06145954, 0.012918472, -0.021681786, -0.010309219, -7.6007843E-4, -0.040925026, 0.060214996, 0.048727036, 0.00532341, -0.011039734, -0.025938034, 0.06612396, 0.11880779, 0.024215698, -0.024374008, -0.02614975, -0.005660057, 0.056134224, -0.011258125, -0.035204887, -0.057831764, 0.055155754, 0.05062008, 0.023088455, 0.081544876, -0.0921669, -0.24857235, -0.24232578, -0.12408066, 0.14921474, 0.28984737, 0.26680756, 0.14722347, -0.03628826, -0.16666412, -0.08552933, -0.09842205, -0.049498558, 0.016926765, 0.157691, 0.20912075, 0.20664406, 0.12963867, -0.19115639, -0.123633385, -0.059150696, 0.0064525604, 0.0629158, 0.074934006, 0.08197594, 0.01982212, -0.019966125, 0.012042046, -0.015429497, -0.06837177, -0.014583588, 0.0045461655, 0.057185173, 0.07053757, 0.019948006, 0.006875038, -0.07112026, -0.012557983, 0.097169876, 0.095300674, 0.0059404373, -0.10860348, -0.055462837, -0.026731491, -0.007762909, -0.7532215, 0.23155594, 1.4837208, 1.1134205]; 
endData = length(data) -1 ; 
 endData = endData*0.01; 
 t = 0:0.01:endData; 
 %% Step 1: resample at fixed time step 
Fs = 100.; % desired (fixed) sample rate 
%[data_resampled,t_resampled] = resample(data,t,Fs); 
t_resampled = t(1):1/Fs:t(end); 
data_resampled = interp1(t, data, t_resampled, 'spline'); 
% to make sure time starts at t = 0s: 
t_resampled = t_resampled - t_resampled(1); 
%% Step 2: Compute amplitude spectrum of the signal 
L = length(data_resampled); 
f = Fs*(0:(L/2))/L; 
A2_data = fft(data_resampled); A2 = abs(A2_data/L); 
A_data = A2(1:L/2+1); A_data(2:end-1) = 2*A_data(2:end-1); 
maxi = max(A_data); 
k = find(A_data==maxi); 
disp(f(k)); 
disp('fase'); 
disp(A_data); 
disp('fase'); 
disp(f); 
disp('fase'); 
%% Step 3: Apply bandbass filter 
% Lowerbound and upperbound cutoff bandpass filter (relative to Nyquist frequency) 
f1 = 1/Fs*2; f2 = 4/Fs*2; 
% [b,a] = butter(n,Wn,ftype) 
filter_order = 4; 
[b,a] = butter(filter_order,[f1 f2]); 
data_filtered = filtfilt(b,a,data_resampled); 
A2_data = fft(data_filtered); A2 = abs(A2_data/L); 
A_data = A2(1:L/2+1); A_data(2:end-1) = 2*A_data(2:end-1); 
maxi = max(A_data); 
k = find(A_data==maxi); 
disp(f(k)); 
disp('fase'); 
disp(A_data); 
