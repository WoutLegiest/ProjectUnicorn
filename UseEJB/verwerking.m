pkg load signal 
data = [-0.62463284, -1.3534698, -1.7355576, -1.8049202, 0.8508606, 2.4878454, 0.7535343, -0.8665104, -0.8366604, 2.0336924, 2.8236637, 2.2937136, -1.6478872, -3.358673, -5.1011353, -5.1032276, -4.319994, -6.4345684, -9.631414, -9.16196, -2.459445, 2.6889915, 2.9275064, 4.1146364, 1.2309551, 2.1277971, 1.4715433, 0.31709385, -0.8961878, -2.3031292, -5.5222654, -7.760355, -9.012458, -7.363744, -3.6771278, 10.046541, 15.754538, 13.3180895, 7.6362762, 0.30252743, -5.10981, -9.456791, -11.009572, -9.701048, -3.28061, 4.8794785, 9.121148, 10.561193, 8.141403, 6.629142, 5.483428, 0.85515213, -7.5550747, -19.506445, -27.509031, -25.822006, -12.083026, 18.694609, 29.541199, 14.735653, 3.5573854, 4.3666897, 3.2961073, -5.401044, -14.92368, -21.58435, -23.215508, -8.815295, 15.298861, 29.52662, 28.596836, 12.223518, 1.5319223, -1.602006, -7.741247, -17.73365, -26.16922, -28.188984, -19.91234, 3.8111706, 30.018826, 29.647802, 7.867915, -2.9364433, -4.9418983, -14.5691395, -21.40851, -21.94373, -16.439201, -0.8563366, 20.99113, 26.337154, 11.893694, 2.2572384, -2.4851294, -8.446508, -19.283718, -20.896248, -11.335366, 9.171078, 27.715246, 24.46437, 10.513214, 0.13132, -4.453656, -10.735896, -19.969978, -20.479095, -11.349138, 14.58311, 29.939625, 18.75732, 2.8624296, -8.534869, -7.969347, -10.943764, -18.465164, -18.330957, -6.5114946, 21.200172, 29.881638, 22.638893, -0.9623699, -11.959623, -12.383323, -12.032998, -14.14432, -10.035883, 11.009073, 29.764841, 21.670391, -0.053100586, -10.052372, -16.520279, -14.900334, -11.271876, -4.148984, 18.6692, 28.871735, 12.179453, -2.9589024, -13.068585, -17.693508, -13.595096, -9.113401, 7.022786, 29.857918, 25.801384, 5.5768347, -11.314716, -15.669842, -12.390002, -13.044814, -8.412696, 4.531866, 13.003772, 10.268635, 4.8446417, 1.252676, 0.39838314, -0.500782, -1.3253212, -1.9837065, -2.4069595, -1.1601334, -0.032456398, 0.4246626, 0.81932735, 0.29917622, 0.32298088, 0.53780556, 0.598649, 0.44281578, 0.05323887, -0.044784546, 0.40719318, 0.39612293, -0.07654095, -0.22373009, -0.11504364, -0.1690321, -0.018463135, -0.0064706802, 0.13982582, 0.961524, -0.91296005, -6.879587, -5.8816023, 7.2781982, 17.870659, 5.773367, -12.420339, -17.236704, -1.8167906, 19.315365, 14.43506, -5.287718, -6.536833, -4.0815287, -5.614753, 4.16689, 3.0420303, -4.918215, -5.8052244, 1.5668316, 8.259271, 10.868394, 3.0855541, -5.2657557, -7.8002796, -8.457191, 2.3744116, 10.2514715, 2.48147, -3.4816313, -2.5848923, -1.057435, 0.5405626, 1.5163546, 1.7824135, 1.7156525, 0.35911942, -0.3291092, 0.39320183, 0.354537, 0.21992588, 0.2911005, 0.4499178, 0.56991863, -0.48376846, -0.89629936, 0.2881384, 0.53082085, 0.43924618, 0.51120186, 0.36045837, -0.040317535, -0.78958035, -0.7803755, -0.21325779, 0.0010461807, -0.06781006, -0.54441166, -0.6304827, -0.055205345, 0.0771122, -0.08991909, -0.07112789, 0.47687912, 1.3645468, 1.8538866, 2.1705046, 1.5639038, 0.051631927, -0.33792877, -1.0504313, -2.0482817, -3.0805902, -5.292094, -11.497677, -15.055105, -6.128706, 8.360055, 17.396046, 13.165802, 2.004816, -8.285219, -15.526526, -6.62535, 7.461815, 12.272587, 8.857199, 4.9192667, 1.5091658, -5.0102644, -10.624457, -7.722192, 8.698164, 7.380164, 1.4926596, -1.6590748, -2.5429602, -5.638788, -6.73343, 0.012535095, 9.402276, 8.95895, 2.5388193, -1.476963, -3.5683298, -6.7295303, -7.5760145, 1.9812593, 10.504718, 6.8432713, 0.35884, -3.0128555, -4.058135, -6.163563, -6.864253, 3.5616827, 10.616963, 3.059185, -1.1798162, -1.969492, -2.738346, -4.7208204, -3.6843119, 4.638935, 6.5044956, 1.4361868, -0.35399628, -1.0162249, -2.995655, 1.9379892, 1.5818062, -1.3917646, -0.8458214, 1.4505358, 1.7566891, 0.43901348, 0.686327, 1.0759315, -0.44843578, -1.3007994, -0.56766796, -0.54804325, -0.811121, -0.3557377, -0.9813614, 1.0786514, -1.1172009, -1.7537479, -1.9908934, -1.9514275, -1.2329683, -0.2797413, -0.26842403, 1.0243387, 2.208043, 1.2422638, 0.14339542, 0.10954094, -0.45500565, -0.2846899, 0.9765806, 1.4482813, 1.1043358, 0.15984535, -0.5768995, -0.8982191, 1.0212021, 0.6175356, -1.3950644, -1.2382536, -0.52967644, 1.6579638, 2.697381, 1.4563866, 0.32640362, 0.20513344, 0.14697361, 0.088661194, -1.8119812E-5, -0.43952656, -1.2497835, -0.8796978, -0.017345428, 0.02941227, 0.0109529495, -0.0066375732, 0.083976746, 0.11979103, -0.061807632, -0.3029375, -0.28320312, 0.22544003, 0.37940693, 0.2649355, 0.19516468, -0.37378597, -2.8161402, 4.434435, 3.2619934, 0.38419437, -4.309757]; 
endData = length(data) -1 ; 
 endData = endData*0.01; 
 t = 0:0.01:endData; 
 %% Step 1: resample at fixed time step 
Fs = 100.; % desired (fixed) sample rate 
%[data_resampled,t_resampled] = resample(data,t,Fs); 
t_resampled = t(1):1/Fs:t(end); 
data_resampled = interp1(t, data, t_resampled, 'spline'); 
% to make sure time starts at t = 0s: 
t_resampled = t_resampled - t_resampled(1); 
%% Step 2: Compute amplitude spectrum of the signal 
L = length(data_resampled); 
f = Fs*(0:(L/2))/L; 
A2_data = fft(data_resampled); A2 = abs(A2_data/L); 
A_data = A2(1:L/2+1); A_data(2:end-1) = 2*A_data(2:end-1); 
maxi = max(A_data); 
k = find(A_data==maxi); 
disp(f(k)); 
disp('fase'); 
disp(A_data); 
disp('fase'); 
disp(f); 
disp('fase'); 
%% Step 3: Apply bandbass filter 
% Lowerbound and upperbound cutoff bandpass filter (relative to Nyquist frequency) 
f1 = 1/Fs*2; f2 = 4/Fs*2; 
% [b,a] = butter(n,Wn,ftype) 
filter_order = 4; 
[b,a] = butter(filter_order,[f1 f2]); 
data_filtered = filtfilt(b,a,data_resampled); 
A2_data = fft(data_filtered); A2 = abs(A2_data/L); 
A_data = A2(1:L/2+1); A_data(2:end-1) = 2*A_data(2:end-1); 
maxi = max(A_data); 
k = find(A_data==maxi); 
disp(f(k)); 
disp('fase'); 
disp(A_data); 
