pkg load signal 
data = [-0.0034599304, 0.0069360733, 0.039235115, 0.04415226, -0.01901722, -0.012546539, 0.028130531, 0.016958237, 0.022263527, 0.018769264, -0.0031614304, 0.0018863678, 0.00228405, 0.042261124, 0.0057878494, 7.982254E-4, 0.0030565262, -4.2152405E-4, 0.032423973, 0.028206825, 0.013648987, 0.020730972, 0.025078773, 0.010056496, 0.01691246, -0.0067977905, 0.02976513, 0.03599453, -0.021298409, 4.4822693E-4, 0.0076084137, 0.010409355, 0.010122299, 0.01869297, -8.34465E-4, -0.010111809, -7.867813E-4, 0.0034866333, 0.019554138, 0.0067539215, 0.018405914, -0.01973629, -0.004453659, 0.0073394775, -2.2411346E-4, 0.0063676834, 0.0040426254, 0.0065813065, -0.00278759, 0.013703346, 0.043831825, 0.019436836, -0.0043792725, -0.00121212, 0.050359726, -0.010178566, -0.0051641464, -0.026456833, 0.021643639, 0.034861565, -0.006385803, -0.04155922, 0.09181118, 0.048290253, -0.07046318, -0.02212143, -0.02008152, 0.026838303, 0.05231476, 0.038414955, -0.0025291443, -0.017022133, -0.039808273, -0.025842667, 0.05915737, -0.06719494, 0.049922943, -0.031114578, 0.0046138763, 0.06101513, -0.039399147, -0.06556702, -0.06984711, -0.03129387, -0.0024557114, 0.065564156, -0.09354305, 0.023314476, 0.02270317, -0.007659912, 0.009765625, 0.027816772, 0.033843994, 0.0199337, 0.010006905, -0.017533302, 0.04913044, 0.033887863, 0.0062417984, -0.062179565, -0.017578125, -8.172989E-4, 0.043411255, -0.018746376, -0.03528309, 0.046079636, 0.030877113, 0.0045108795, -0.021037102, 0.026683807, 9.460449E-4, 0.02739811, -0.013660431, -0.019580841, -0.059744835, 0.007795334, -0.077664375, -0.038823128, 0.07282829, 0.05012417, -0.04350567, 0.016231537, -0.06832695, 0.0034599304, 0.06565666, 0.0048980713, -0.021956444, 0.052074432, -0.029847145, 0.04070568, 0.012160301, -0.12971497, 0.004753113, 0.1289959, 0.03420353, -0.04576397, -0.048975945, 0.008533478, 0.03691864, 0.033504486, 0.028616905, -0.006336212, 0.0749197, -0.046556473, 0.046144485, 0.037730217, -0.0239048, 0.040670395, 0.008763313, -0.019652367, 0.007446289, -0.028000832, 0.024403572, 9.1457367E-4, 0.05477619, 0.08049202, 0.049513817, -0.059449196, 0.062300682, -0.00992012, -0.040776253, -0.017763138, -0.015130997, 0.11383057, -0.11694622, 0.017575264, -0.033439636, -0.0032920837, -0.112381935, -0.04045105, 0.039800644, 0.064813614, -0.07139778, -0.036859512, -0.03438282, -0.078154564, 0.027463913, -0.02762127, 0.003484726, 0.050769806, 0.13552761, -0.04921627, -0.038165092, -0.016904831, 0.02391243, -0.56738853, 0.21426201, -0.0031404495, -0.08253384]; 
endData = length(data) -1 ; 
 endData = endData*0.01; 
 t = 0:0.01:endData; 
 %% Step 1: resample at fixed time step 
Fs = 100.; % desired (fixed) sample rate 
%[data_resampled,t_resampled] = resample(data,t,Fs); 
t_resampled = t(1):1/Fs:t(end); 
data_resampled = interp1(t, data, t_resampled, 'spline'); 
% to make sure time starts at t = 0s: 
t_resampled = t_resampled - t_resampled(1); 
%% Step 2: Compute amplitude spectrum of the signal 
L = length(data_resampled); 
f = Fs*(0:(L/2))/L; 
A2_data = fft(data_resampled); A2 = abs(A2_data/L); 
A_data = A2(1:L/2+1); A_data(2:end-1) = 2*A_data(2:end-1); 
maxi = max(A_data); 
k = find(A_data==maxi); 
disp(f(k)); 
disp('fase'); 
disp(A_data); 
disp('fase'); 
disp(f); 
disp('fase'); 
%% Step 3: Apply bandbass filter 
% Lowerbound and upperbound cutoff bandpass filter (relative to Nyquist frequency) 
f1 = 1/Fs*2; f2 = 4/Fs*2; 
% [b,a] = butter(n,Wn,ftype) 
filter_order = 4; 
[b,a] = butter(filter_order,[f1 f2]); 
data_filtered = filtfilt(b,a,data_resampled); 
A2_data = fft(data_filtered); A2 = abs(A2_data/L); 
A_data = A2(1:L/2+1); A_data(2:end-1) = 2*A_data(2:end-1); 
maxi = max(A_data); 
k = find(A_data==maxi); 
disp(f(k)); 
disp('fase'); 
disp(A_data); 
