pkg load signal 
data = [0.7248905, 0.6287303, 0.43770504, 0.34959245, 0.21543813, 0.43549943, 0.2122333, 0.35543466, 0.20722914, 0.44233775, -0.028187275, -0.37483692, -0.5099194, -0.30941296, 0.15571141, 1.0293417, 0.784549, 0.3347249, 0.47327757, 0.79759073, 1.5813841, 1.3785962, 0.35197783, 0.063616395, -0.34010458, -0.12985834, -0.9789344, -3.468443, -4.6939673, -4.718767, -7.033646, -8.765318, -7.2481213, -4.486311, -2.920085, 5.088187, 12.271725, 11.790845, 11.600259, 12.600418, 13.330724, 1.6563482, -11.076214, -18.178757, -19.392654, -17.584171, -11.846959, -6.543369, -2.070136, 1.0908514, 3.627579, 6.247529, 8.400428, 9.972329, 9.372093, 5.682019, 1.8676748, -0.3838451, -1.8046442, -3.2188914, -2.8967247, -3.404562, -1.5006888, -0.19261575, -0.0131623745, 0.85187364, 1.2017331, 2.434702, 2.7790685, 2.424167, 0.24025607, 0.03690958, 0.22828293, 0.34044838, -0.04761362, -0.24902844, -0.5253043, -0.3144126, 0.03608632, 0.11447525, -0.19290447, -0.19400692, 0.22254395, 0.673785, 0.44330835, 0.10382295, 0.042993546, 0.052485704, -0.015417337, -0.013249397, 0.19314313, 0.20406842, -0.017810583, -0.11245012, -0.21079278, 0.034050703, 0.08023906, 0.1337471, -0.0026359558, 0.1864903, -0.25475025, -0.4736004, -0.45715308, -0.7611984, -1.2431794, -1.8882575, -3.4539938, -5.3889623, -7.008739, -8.393821, -9.9693, -6.6821027, -3.207909, 3.0639758, 11.622713, 10.97245, 10.672528, 10.561325, 10.573567, 10.603333, 10.489661, 6.986787, 7.5064073, 5.5013776, 1.3489985, -0.2486, -5.8529587, -6.868067, -7.9078574, -8.180717, -6.5857205, -6.083859, -5.658281, -6.0761485, -6.9793653, -7.21725, -6.223118, -3.7365248, -1.1647558, 0.127361, 4.9998913, 7.5456457, 7.4529266, 5.465763, 3.7500615, 2.7292933, 1.1770458, 0.110031605, -0.60930204, -0.6751473, -0.38222003, -0.35480833, -0.4513564, -0.07571554, -0.21445084, -0.22768784, -0.2830341, 0.013180733, 0.22999215, 0.15079665, -0.030768394, -0.28410912, -0.16133904, 2.4140203, -0.24280739, -1.1253443, -0.534775, -0.122709036, 0.2968347, 0.17975044, -0.117916584, 0.080010176, 0.047394514, -0.25189805, -0.3155074, -0.22923446, -0.184304, -0.21908116, -0.36829996, -0.36277986, -0.21135211, 0.020968914, 0.13585901, 0.10722327, -0.4530549, -0.2847631, -0.06594324, -0.10836482, -0.18807769, -0.31158972, -2.6893616E-4]; 
endData = length(data) -1 ; 
 endData = endData*0.01; 
 t = 0:0.01:endData; 
 %% Step 1: resample at fixed time step 
Fs = 100.; % desired (fixed) sample rate 
%[data_resampled,t_resampled] = resample(data,t,Fs); 
t_resampled = t(1):1/Fs:t(end); 
data_resampled = interp1(t, data, t_resampled, 'spline'); 
% to make sure time starts at t = 0s: 
t_resampled = t_resampled - t_resampled(1); 
%% Step 2: Compute amplitude spectrum of the signal 
L = length(data_resampled); 
f = Fs*(0:(L/2))/L; 
A2_data = fft(data_resampled); A2 = abs(A2_data/L); 
A_data = A2(1:L/2+1); A_data(2:end-1) = 2*A_data(2:end-1); 
maxi = max(A_data); 
k = find(A_data==maxi); 
disp(f(k)); 
disp('fase'); 
disp(A_data); 
disp('fase'); 
disp(f); 
disp('fase'); 
%% Step 3: Apply bandbass filter 
% Lowerbound and upperbound cutoff bandpass filter (relative to Nyquist frequency) 
f1 = 1/Fs*2; f2 = 4/Fs*2; 
% [b,a] = butter(n,Wn,ftype) 
filter_order = 4; 
[b,a] = butter(filter_order,[f1 f2]); 
data_filtered = filtfilt(b,a,data_resampled); 
A2_data = fft(data_filtered); A2 = abs(A2_data/L); 
A_data = A2(1:L/2+1); A_data(2:end-1) = 2*A_data(2:end-1); 
maxi = max(A_data); 
k = find(A_data==maxi); 
disp(f(k)); 
disp('fase'); 
disp(A_data); 
